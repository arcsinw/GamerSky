<Page
    x:Class="GamerSky.Views.GamePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:GamerSky.Views"
    xmlns:vm="using:GamerSky.ViewModels"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:GamerSky.Controls"
    mc:Ignorable="d"
    >

    <Page.DataContext>
        <vm:GamePageViewModel x:Name="ViewModel"/>
    </Page.DataContext>

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"> 
        <Grid.RowDefinitions>
            <RowDefinition Height="48"/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" BorderThickness="0,0,0,1" BorderBrush="LightGray" Padding="12,0,0,0">
            <TextBlock Text="游戏" FontSize="20" VerticalAlignment="Center"/>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Style="{StaticResource ImageButtonStyle}" Padding="12" Height="48" Width="48" Click="{x:Bind Show}">
                    <Image Source="/Assets/Images/ic_game_history.png"/>
                </Button>

                <Button Style="{StaticResource ImageButtonStyle}" Padding="12" Height="48" Width="48" Click="{x:Bind Hide}">
                    <Image Source="/Assets/Images/ic_search.png"/>
                </Button>
            </StackPanel>
        </Grid>

        <ItemsControl Grid.Row="1">
            <!--<ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <VirtualizingStackPanel/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>-->
            <ItemsControl.Resources>

                <Style TargetType="TextBlock" x:Key="HeaderTextBlockStyle">
                    <Setter Property="HorizontalAlignment" Value="Left"/>
                    <Setter Property="VerticalAlignment" Value="Center"/>
                    <Setter Property="Margin" Value="12,0,0,0"/>
                </Style>

                <ItemsPanelTemplate x:Key="HorizontalItemsPanel">
                    <ItemsStackPanel Orientation="Horizontal"/>
                </ItemsPanelTemplate>

                <Style TargetType="ListView">
                    <Setter Property="ItemsPanel" Value="{StaticResource HorizontalItemsPanel}"/>
                    <Setter Property="ItemContainerStyle">
                        <Setter.Value>
                            <Style TargetType="ListViewItem">
                                <Setter Property="MaxHeight" Value="210"/>
                                <Setter Property="MaxWidth" Value="120"/>
                                <Setter Property="Margin" Value="0,0,12,0"/>
                                <Setter Property="Padding" Value="0"/>
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                            </Style>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Hidden"/>
                    <Setter Property="ScrollViewer.HorizontalScrollMode" Value="Enabled"/>
                    <Setter Property="ScrollViewer.VerticalScrollMode" Value="Disabled"/>
                </Style>

                <Style TargetType="Grid" x:Key="TitleGridStyle">
                    <Setter Property="Margin" Value="0,12,0,12"/>
                </Style>

                <Style TargetType="Button" x:Key="PartButtonStyle" BasedOn="{StaticResource ImageButtonStyle}">
                    <Setter Property="HorizontalAlignment" Value="Center"/>
                    <Setter Property="Height" Value="64"/>
                    <Setter Property="Width" Value="64"/>
                </Style>

                <Style TargetType="TextBlock">
                    <Setter Property="HorizontalAlignment" Value="Center"/>
                    <Setter Property="FontSize" Value="14"/>
                </Style>

                <Style TargetType="StackPanel" x:Key="PartStackPanelStyle">
                    <Setter Property="Margin" Value="12,0"/>
                </Style>
            </ItemsControl.Resources>
            <ItemsControl.Template>
                <ControlTemplate TargetType="ItemsControl">
                    <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}">
                        <ScrollViewer x:Name="ScrollViewer" AutomationProperties.AccessibilityView="Raw" BringIntoViewOnFocusChange="{TemplateBinding ScrollViewer.BringIntoViewOnFocusChange}" 
                                          HorizontalScrollMode="{TemplateBinding ScrollViewer.HorizontalScrollMode}" HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}" IsHorizontalRailEnabled="{TemplateBinding ScrollViewer.IsHorizontalRailEnabled}" IsHorizontalScrollChainingEnabled="{TemplateBinding ScrollViewer.IsHorizontalScrollChainingEnabled}" IsVerticalScrollChainingEnabled="{TemplateBinding ScrollViewer.IsVerticalScrollChainingEnabled}" IsVerticalRailEnabled="{TemplateBinding ScrollViewer.IsVerticalRailEnabled}" IsDeferredScrollingEnabled="{TemplateBinding ScrollViewer.IsDeferredScrollingEnabled}" TabNavigation="{TemplateBinding TabNavigation}" VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}" VerticalScrollMode="{TemplateBinding ScrollViewer.VerticalScrollMode}" ZoomMode="{TemplateBinding ScrollViewer.ZoomMode}" 
                                      Style="{StaticResource LightScrollViewerStyle}">
                            <ItemsPresenter Padding="{TemplateBinding Padding}"/>
                        </ScrollViewer>
                    </Border>
                </ControlTemplate>
            </ItemsControl.Template>
            <ItemsControl.Items>
                <Grid Height="100" BorderBrush="LightGray" BorderThickness="0,0,0,1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                        <Button Style="{StaticResource PartButtonStyle}" >
                            <Image Source="/Assets/Images/ic_game_tszt.png"/>
                        </Button>
                        <TextBlock Text="特色专题" />
                    </StackPanel>

                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <Button Style="{StaticResource PartButtonStyle}" >
                            <Image Source="/Assets/Images/ic_game_phb.png"/>
                        </Button>
                        <TextBlock Grid.Column="1" Text="排行榜" />
                    </StackPanel>

                    <StackPanel Grid.Column="2" VerticalAlignment="Center">
                        <Button Style="{StaticResource PartButtonStyle}">
                            <Image Source="/Assets/Images/ic_game_fsb.png"/>
                        </Button>
                        <TextBlock Grid.Column="2" Text="发售表" />
                    </StackPanel>

                    <StackPanel Grid.Column="3" VerticalAlignment="Center">
                        <Button Style="{StaticResource PartButtonStyle}">
                            <Image Source="/Assets/Images/ic_game_wjdp.png"/>
                        </Button>
                        <TextBlock Grid.Column="3" Text="玩家点评" />
                    </StackPanel>

                    <StackPanel Grid.Column="4" VerticalAlignment="Center">
                        <Button Style="{StaticResource PartButtonStyle}">
                            <Image Source="/Assets/Images/ic_game_zyx.png"/>
                        </Button>
                        <TextBlock Grid.Column="4" Text="找游戏" />
                    </StackPanel>
                </Grid>

                <StackPanel Orientation="Vertical" Style="{StaticResource PartStackPanelStyle}">
                    <Grid Style="{StaticResource TitleGridStyle}">
                        <Rectangle Height="24" Width="4" Fill="{ThemeResource ThemeColorBrush}" HorizontalAlignment="Left"/>
                        <TextBlock Text="新游推荐" Style="{StaticResource HeaderTextBlockStyle}"/>
                        <HyperlinkButton Content="全部" HorizontalAlignment="Right"/>
                    </Grid>
                    <FlipView ItemsSource="{Binding NewGames}" Height="Auto" MaxHeight="300">
                        <FlipView.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <controls:ImageEx Source="{Binding LargeImage}" 
                                                      PlaceholderSource="{StaticResource GamePlaceHolderImage}"
                                                      Stretch="UniformToFill"/>
                                    <StackPanel VerticalAlignment="Bottom">
                                        <TextBlock Foreground="White" TextWrapping="Wrap" Margin="24">
                                    <Run Text="{Binding Title}" FontSize="20"/>
                                    <LineBreak/>
                                    <Run Text="{Binding Description}"/>
                                        </TextBlock>
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </FlipView.ItemTemplate>
                    </FlipView>
                </StackPanel>

                <StackPanel Orientation="Vertical" Style="{StaticResource PartStackPanelStyle}">
                    <Grid Style="{StaticResource TitleGridStyle}">
                        <Rectangle Height="24" Width="4" Fill="{ThemeResource ThemeColorBrush}" HorizontalAlignment="Left"/>
                        <TextBlock Text="最近大家都在玩" Style="{StaticResource HeaderTextBlockStyle}"/>
                        <Button Content="全部" HorizontalAlignment="Right"/>
                    </Grid>
                    <ListView ItemsSource="{Binding RecentGames}">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <StackPanel Orientation="Vertical">
                                        <Image Source="{Binding DefaultPicUrl}"/>
                                        <TextBlock Text="{Binding Title}" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackPanel>

                <StackPanel Orientation="Vertical" Style="{StaticResource PartStackPanelStyle}">
                    <Grid Style="{StaticResource TitleGridStyle}">
                        <Rectangle Height="24" Width="4" Fill="{ThemeResource ThemeColorBrush}" HorizontalAlignment="Left"/>
                        <TextBlock Text="特色专题" Style="{StaticResource HeaderTextBlockStyle}"/>
                        <Button Content="全部" HorizontalAlignment="Right"/>
                    </Grid>
                    <ListView ItemsSource="{Binding GameSpecialList}">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Border Height="130" Width="180" CornerRadius="2">
                                    <Border.Background>
                                        <ImageBrush ImageSource="{Binding SmallImage}"/>
                                    </Border.Background>
                                </Border>
                                <!--<controls:ImageEx Source="{Binding SmallImage}"/>-->
                            </DataTemplate>
                        </ListView.ItemTemplate>
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="MaxWidth" Value="200"/>
                                <Setter Property="Padding" Value="0"/>
                                <Setter Property="Margin" Value="0,0,12,0"/>
                            </Style>
                        </ListView.ItemContainerStyle>
                    </ListView>
                </StackPanel>

                <StackPanel Orientation="Vertical" Style="{StaticResource PartStackPanelStyle}">
                    <Grid Style="{StaticResource TitleGridStyle}">
                        <Rectangle Height="24" Width="4" Fill="{ThemeResource ThemeColorBrush}" HorizontalAlignment="Left"/>
                        <TextBlock Text="即将上市" Style="{StaticResource HeaderTextBlockStyle}"/>
                        <Button Content="全部" HorizontalAlignment="Right"/>
                    </Grid>
                    <ListView ItemsSource="{Binding NewSellingGames}">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <StackPanel Orientation="Vertical">
                                        <Image Source="{Binding DefaultPicUrl}" HorizontalAlignment="Center" Stretch="UniformToFill"/>
                                        <TextBlock Text="{Binding Title}" HorizontalAlignment="Center" TextTrimming="Clip"/>
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackPanel>

                <StackPanel Orientation="Vertical" Style="{StaticResource PartStackPanelStyle}">
                    <Grid Style="{StaticResource TitleGridStyle}">
                        <Rectangle Height="24" Width="4" Fill="{ThemeResource ThemeColorBrush}" HorizontalAlignment="Left"/>
                        <TextBlock Text="高分榜" Style="{StaticResource HeaderTextBlockStyle}"/>
                        <Button Content="全部" HorizontalAlignment="Right"/>
                    </Grid>
                    <ListView ItemsSource="{Binding HighRankedGames}">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <StackPanel Orientation="Vertical">
                                        <Image Source="{Binding DefaultPicUrl}"/>
                                        <TextBlock Text="{Binding Title}" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackPanel>

                <StackPanel Orientation="Vertical" Style="{StaticResource PartStackPanelStyle}">
                    <Grid Style="{StaticResource TitleGridStyle}">
                        <Rectangle Height="24" Width="4" Fill="{ThemeResource ThemeColorBrush}" HorizontalAlignment="Left"/>
                        <TextBlock Text="最期待游戏" Style="{StaticResource HeaderTextBlockStyle}"/>
                        <Button Content="全部" HorizontalAlignment="Right"/>
                    </Grid>
                    <ListView ItemsSource="{Binding MostExpectedGames}">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <StackPanel Orientation="Vertical">
                                        <controls:ImageEx Source="{Binding DefaultPicUrl}" Height="160"
                                                          Stretch="UniformToFill"/>
                                        <TextBlock HorizontalAlignment="Left" Foreground="#21B56F">
                                            <Run Text="{Binding WantPlayCount}"></Run>
                                            <Run Text="人期待"/>
                                        </TextBlock>
                                        <TextBlock Text="{Binding Title}" HorizontalAlignment="Left"/>
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackPanel>

                <StackPanel Orientation="Vertical" Style="{StaticResource PartStackPanelStyle}">
                    <Grid Style="{StaticResource TitleGridStyle}">
                        <Rectangle Height="24" Width="4" Fill="{ThemeResource ThemeColorBrush}" HorizontalAlignment="Left"/>
                        <TextBlock Text="找游戏" Style="{StaticResource HeaderTextBlockStyle}"/>
                        <Button Content="全部" HorizontalAlignment="Right"/>
                    </Grid>
                    <ListView>

                    </ListView>
                </StackPanel>
            </ItemsControl.Items>
        </ItemsControl>
    </Grid>
</Page>